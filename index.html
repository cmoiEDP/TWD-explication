<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Placeholder</title>
  <link rel="icon" href="/favicon.jpg" type="image/jpg">
  <link href="styles.css" rel="stylesheet" />
</head>
<body>
  <div class="sidebar">
    <div class="folder">
      <div class="element">
        <a>Saisons</a>
        <div class="dropdown">
          <a href ="?page=s01">Saison 1</a>
          <a href ="?page=s02">Saison 2</a>
          <a href ="?page=s03">Saison 3</a>
          <a href ="?page=s04">Saison 4</a>
          <a href ="?page=s05">Saison 5</a>
          <a href ="?page=s06">Saison 6</a>
          <a href ="?page=s07">Saison 7</a>
          <a href ="?page=s08">Saison 8</a>
          <a href ="?page=s09">Saison 9</a>
          <a href ="?page=s10">Saison 10</a>
          <a href ="?page=s11">Saison 11</a>
        </div>
        <a>En +</a>
        <div class="dropdown">
          <a href ="?page=acteur">casting</a>
          <a href ="?page=lore"> le lore ?</a>
          <a href ="?page=amc"> AMC </a>
        </div>
      </div>
    </div>
  </div>

  <div class="main_panel"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const page = params.get("page") || "landing-page";
    const mainPanel = document.querySelector(".main_panel");
    let actorsData = [];

    // Charger les données JSON
    async function loadActorsData() {
  try {
    const response = await fetch('src/json/modals.json');
    actorsData = await response.json();
  } catch (error) {
    console.error('❌ Erreur lors du chargement des données:', error);
  }
}

// Modifiez la fonction generateActorCards
function generateActorCards(season) {
  const seasonData = actorsData.find(s => s.season === season);
  if (!seasonData || !seasonData.actors.length) {
    return '<p>Aucun acteur trouvé pour cette saison.</p>';
  }

  return seasonData.actors.map(actor => `
    <div class="actor-card" data-actor="${actor.actor}">
      <div id="actor-profile">
        <img src="${actor.img}" alt="${actor.actor}"/>
        <h3>${actor.actor}</h3>
        <p>${actor.quickdescription}</p>
      </div>
    </div>
  `).join('');
}

    async function renderPage() {
      await loadActorsData();

      switch (page) {
        case "landing-page":
          mainPanel.innerHTML = `
            <div class="welcome-message">
              <h1>Bienvenue sur la page d'accueil</h1>
            </div>
            <div class="warning">
            <button class="close-warning">✖</button>
            <p>
            Ce site contient beaucoup de spoilers sur la série The Walking Dead. Soyez prudent si vous n'êtes pas à jour avec la série !
            </p>
            <p>Les dits spoilers seront masqués jusqu'au survol.</p>
            <p>Voici un spoiler</p> <span class="spoiler"> Gabriel & Ruben </span>
            </div>
            <div class="content">
            <p> Voici une liste de tout ce qui est present sur le site :</p>
            <ul>
              <li>Des explications détaillées sur chaque saison de The Walking Dead.</li>
              <li>Des informations sur le casting et les acteurs de la série.</li>
              <li> Et beaucoup de spoilers ! </li>
            </ul>
            </div>
            <div class="nav_button">
              <button class="next-btn" onclick="window.location.href='?page=s01'">Commencer par le commencement</button>
            </div>
          `;
          break;
        case "acteur":
          mainPanel.innerHTML = `
            <h1>Casting</h1>
            <p>Envoyez-nous un message via le formulaire ci-dessous.</p>
          `;
          break;
        case "lore":
          mainPanel.innerHTML = `
            <h1>le Lore</h1>
            <p>un lore </p>
          `;
          break;
        case "s01":
          mainPanel.innerHTML = `
            <h1 class="saison-header">La Saison 1</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s01')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 1</h2>
            </div>
          `;
          break;
        case "s02":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 2</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s02')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 2</h2>
          `;
          break;
        case "s03":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 3</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s03')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 3</h2>
            </div>
          `;
          break;
        case "s04":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 4</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s04')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 4</h2>
            </div>
          `;
          break;
        case "s05":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 5</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s05')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 5</h2>
            </div>
          `;
          break;
        case "s06":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 6</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s06')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 6</h2>
            </div>
          `;
          break;
        case "s07":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 7</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s07')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 7</h2>
            </div>
          `;
          break;
        case "s08":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 8</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s08')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 8</h2>
            </div>
          `;
          break;
        case "s09":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 9</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s09')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 9</h2>
            </div>
          `;
          break;
        case "s10":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 10</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s10')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 10</h2>
            </div>
          `;
          break;
        case "s11":
          mainPanel.innerHTML = `
            <h1 class="saison-header">Saison 11</h1>
            <div class="casting-card">
              <h2>Les personnages principaux :</h2>
              <div class="casting">
                ${generateActorCards('s11')}
              </div>
            </div>
            <div class="content">
              <h2 class="content-header">Résumé de la saison 11</h2>
            </div>
          `;
          break;
        case "amc":
          mainPanel.innerHTML = `
            <h1>AMC</h1>
            <p>Contenu sur AMC.</p>
          `;
          break;
        default:
          mainPanel.innerHTML = `
            <h1>404 - Page introuvable</h1>
            <p>La page demandée n'existe pas.</p>
          `;
          break;
      }

      // Attacher les événements après le rendu
      attachEventListeners();
    }

    function attachEventListeners() {
      document.querySelectorAll('.folder .element > a').forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const dropdown = link.nextElementSibling;
          if (dropdown) {
            dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
          }
        });
      });

      document.addEventListener('click', e => {
        if (!e.target.closest('.folder .element')) {
          document.querySelectorAll('.dropdown').forEach(d => d.style.display = 'none');
        }
      });

      document.querySelector('.close-warning')?.addEventListener('click', () => {
        document.querySelector('.warning').remove();
      });

      // Navigation entre saisons
      const totalSeasons = 11;
      const navContainer = document.createElement("div");
      navContainer.className = "nav_button";
      let navHTML = "";

      if (page.startsWith("s")) {
        const currentSeason = parseInt(page.slice(1));
        if (currentSeason > 1) {
          const prevPage = `s${String(currentSeason - 1).padStart(2, "0")}`;
          navHTML += `<button class="prev-btn" onclick="window.location.href='?page=${prevPage}'"> <img src="src/img/back_arrow.svg" width="18" height="18"> Saison ${currentSeason - 1}</button>`;
        } else {
          navHTML += `<button class="home-btn" onclick="window.location.href='?page=landing-page'">Accueil</button>`;
        }
        if (currentSeason < totalSeasons) {
          const nextPage = `s${String(currentSeason + 1).padStart(2, "0")}`;
          navHTML += `<button class="next-btn" onclick="window.location.href='?page=${nextPage}'">Saison ${currentSeason + 1} <img src="src/img/arrow.svg" width="18" height="18"></button>`;
        } else {
          navHTML += `<button class="home-btn" onclick="window.location.href='?page=landing-page'">Vers le casting</button>`;
        }

        navContainer.innerHTML = navHTML;
        mainPanel.appendChild(navContainer);
      }

      // Active tab
      const currentSeason = params.get("page");
      if (currentSeason && currentSeason.startsWith("s")) {
        const link = document.querySelector(`.dropdown a[href='?page=${currentSeason}']`);
        if (link) {
          link.id = "active-tab";
        }
      }

      // Attacher les modals
      refreshCastingModals();
    }

    function attachModalToCasting() {
  const actorCards = document.querySelectorAll(".actor-card");
  actorCards.forEach(card => {
    card.style.cursor = "pointer";

    card.addEventListener("click", (e) => {
      const actorName = card.getAttribute('data-actor');
      
      // Chercher l'acteur dans toutes les saisons
      let actorInfo;
      for (const season of actorsData) {
        actorInfo = season.actors.find(a => a.actor === actorName);
        if (actorInfo) break;
      }

      if (actorInfo) {
        openModal(actorInfo);
      }
    });
  });
}

    function openModal(actor) {
      let modal = document.getElementById("modal");
      if (!modal) {
        modal = document.createElement("div");
        modal.id = "modal";
        modal.classList.add("modal");
        document.body.appendChild(modal);
      }

      modal.innerHTML = `
        <div class="modal-content">
          <button class="close-modal">×</button>
          <img src="${actor.img}" alt="${actor.actor}">
          <h2>${actor.actor}</h2>
          <h4 class="description">${actor.quickdescription}</h4>
          <p>${actor.fulldescription}</p>
        </div>
      `;

      modal.classList.add("active");

      modal.querySelector(".close-modal").addEventListener("click", () => modal.classList.remove("active"));
      modal.addEventListener("click", e => {
        if (e.target === modal) modal.classList.remove("active");
      });
    }

    function refreshCastingModals() {
      attachModalToCasting();
    }

    // Initialiser la page
    renderPage();
  </script>
</body>

</html>

